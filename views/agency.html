<%- include('header.html') -%>
<%- include('side_bar.html') -%>
<div class="container-fluid mt-5">

       <button type="button" class="btn btn-primary m-md-3" data-bs-toggle="modal" data-bs-target="#myModal" onclick="show_mode();">
           Add Agency
         </button
   
        >

   
         

           <!-- DataTales Example -->
           <div class="card shadow mb-4">    
               <div class="card-header py-3">
                   <h6 class="m-0 font-weight-bold text-primary">Agencies</h6>
               </div>
            

               <div class="card-body">
                   <div class="table-responsive">
                       <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                           <thead>
                               <tr>
                                   <th>Agency Name</th>
                                   <th>Agency Phone</th>
                                   <th>Agency Email</th>
                                   <th>Action</th>
                         
                               </tr>
                           </thead>
                         
                           <tbody>
                               <% doct.forEach( function(d){ %>
                                   <tr>
                                       <td><%= d.name %></td>
                                       <td><%= d.phone %></td>
                                       <td><%= d.email %></td> 
                                    <td> <span  class="btn btn-warning" onclick="edit(`<%= d._id%>`,`<%= d.name%>`,`<%= d.phone%>`,`<%= d.email%>`,`<%= d.department_id%>`)"> <i class="fa fa-edit"></i> </span>
                                    
                                        <span  class="btn btn-danger " onclick="deleteLSItem()"><i class="fa fa-trash text-light  text-center"></i> </span>
                                    </td>
                                   
                                 
                                   </tr> 
                              <% })%>
                              
                           </tbody>
                       </table>
                   </div>
               </div>
           </div>

       </div>
       </div>
       <!-- /.container-fluid -->



<div class="modal fade " id="myModal"   role="dialog" aria-hidden="true">
   <div class="modal-dialog" role="document">
       <div class="modal-content bg-primary">
           <div class="modal-header">
               <h5 class="modal-title" id="exampleModalLabel">Add Agency</h5>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
               </button>
           </div>
            
               <div class="modal-body">
                  
        <form action="/save_doctor" method="post"  >
           <div class="row">
               <div class="col-lg-12 ">
               <label class="text-white">Agency Name</label>
               <input type="text"  class="form-control" name="name" id="name">
            </div>
            <div class="col-lg-12">
               <label class="text-white">Phone</label>
               <input type="text"  class="form-control" name="phone" id="phone">
            </div>
            <div class="col-lg-12">
               <label class="text-white">Email</label>
               <input type="text"  class="form-control" name="email" id="email">
            </div>
            <div class="col-lg-12">
               <label class="text-white">Flight</label>
                <select class="form-control" style="width: 100%;" id="department_id" name="department_id">
                    <% data.forEach(function(d){ %>
                        <option value="<%= d._id%>"> <%=d.name%> </option>
                    <% })%>
              
                </select>
            </div>
         
            
         
         
          </div> 
          <div class="modal-footer"> 
           <button type="submit" class="btn btn-warning text-black ">Save </button>
       </div>
   </form>
       
               </div>
             
           
       </div>
   </div>
</div>

   
<div class="modal fade" id="editModal"   role="dialog" aria-hidden="true">
   <div class="modal-dialog" role="document">
       <div class="modal-content bg-primary">
           <div class="modal-header">
               <h5 class="modal-title" id="exampleModalLabel">Edit Agency </h5>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span>
               </button>
           </div>
            
               <div class="modal-body">
                  
        <form action="/edit_doc" method="post"  >
           <input type="hidden" name="_id" id="_id">
           <div class="row">
               <div class="col-lg-12">
                 
               <label class="text-white">Name</label>
               <input type="text"  class="form-control" name="_name" id="_name">
            </div>
            <div class="col-lg-12">
          
           <label class="text-white">Phone</label>
           <input type="text"  class="form-control" name="_phone" id="_phone">
        </div>
        <div class="col-lg-12">
         
       <label class="text-white">Email</label>
       <input type="text"  class="form-control" name="_user_name" id="_user_name">
    </div>
         
        
         

         
         
          </div> 
          <div class="modal-footer"> 
           <button type="submit" class="btn btn-warning">Save </button>
       </div>
   </form>
       
               </div>
             
           
       </div>
   </div>
</div>
</div>

<script>
   function show_mode(){ 
       $('#myModal').modal('show');
   }
   function edit(_id,name,phone,user_name,password){  
       $('#_name').val(name)
       $('#_phone').val(phone)
       $('#_user_name').val(user_name)
       $('#_password').val(password)
       $('#_id').val(_id)
       $('#editModal').modal('show');
   }
   async function deleteLSItem(){
  
  let options = {
    method: 'DELETE',
    headers: {
      'Content-Type': 'html'
    }
  };

  const response = await fetch('/del_doc' , options);
  const data = await response.json();
  console.log(data);
}
       </script>

<!-- Footer -->
<footer class="sticky-footer bg-white">
   <div class="container my-auto">
       <div class="copyright text-center my-auto">
           <span>Copyright &copy; Your Website 2021</span>
       </div>
   </div>
</footer>
<!-- End of Footer -->

</div>
<!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->


<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>

<!-- Page level plugins -->
<script src="vendor/chart.js/Chart.min.js"></script>

<!-- Page level custom scripts -->
<script src="js/demo/chart-area-demo.js"></script>
<script src="js/demo/chart-pie-demo.js"></script>